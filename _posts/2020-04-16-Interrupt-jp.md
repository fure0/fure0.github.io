---
layout: post
categories: "os"
title: "Interrput"
author: "TY_K"
---

## Interrput

プログラムを実行する途中で予期せぬ状況が発生した場合、現在実行中の作業を直ちに中断し、発生した状況を優先処理した後、実行中の作業に復帰して処理し続けること。

外部/内部InterrputはCPUのハードウェア信号によって発生

ソフトウェアInterrputはコマンドの遂行によって発生

* 外部 Interrput

    入出力装置、タイミング装置、電源など外部要因で発生
>   電源異常、機械エラー、外部信号、入出力

* 内部 Interrput

    Trapと呼び、間違った命令やデータを使用する際に発生
>   0で割ることが発生、オーバーフロー、コマンドを誤って使用した場合(Exception)

* ソフトウェア Interrput

    プログラム処理中、命令の要請によって発生したもの(SVCInterrput)
>   ユーザーがプログラムを実行させる際に発生
>   ソフトウェア利用中に他のプロセスを実行させると、時分割処理のためにリソース割当動作が遂行される。

## Interrput発生処理過程

* ソフトウェア Interrput主プログラムが実行される途中で割り込みが発生した。

現在実行中のプログラムを止めて、ステータスレジスタやPCなどをスタックにしばらく保存した後、Interrputサービスルーチンに行く。 しばらく保存する理由は、Interrputサービスルーチンが終わった後、再び元の作業に戻らなければならないため。

Interrput機能がなかったら、コントローラーは特定のタイミングを知るためにチェックを続けるべきである。 (これをポーリング(Polling)という)

ポーリングをする時間には、もともとしていた仕事に集中することができなくなり、多くの機能をきちんと遂行できないという短所があった。

すなわち、コントローラが入力を受け入れる方法(優先順位判別方法)には二つがある。

* ポーリング方式

    ユーザーがコマンドを使って入力ピンの値を読み続け、変化を探り出す方式

    Interrput要請フラグを順番に比較し、優先順位が最も高いInterrput資源を探し出し、それに合った割り込みサービスルーチンを行う。 (ハードウェアに比べて速度が遅い)

* Interrput方式

    MCU自体がハードウェア的に変化をチェックし、変化時のみ一定の動作を行う方式
    - Daisy Chain
    - 並列優先順位付け

Interrput方式はハードウェアでサポートを受けなければならない制約があるが、ポーリングに比べて迅速に対応することが可能である。 したがって'リアルタイム対応'が必要なときは必須の機能である。

つまり、Interrputは発生時期を予測しにくい場合にコントローラが最も早く対応できる方法である。

[参照][Interrput]

[Interrput]: https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer%20Science/Operation%20System/Interrupt.md "Interrput"